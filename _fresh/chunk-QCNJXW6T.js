import{a as d,b as Z,c as ee,d as te,e as se,f as v,g as ie,h as a,i as G}from"./chunk-LW3DSM7G.js";import{a as J,c as L,d as g,e as B,f as X,g as j,h as D,i as q}from"./chunk-MWQOEWO2.js";import{c as A,d as _}from"./chunk-I5ONZ64L.js";import{a as f,c,e as u,f as o}from"./chunk-FW6O5JPS.js";var oe=15,ae=30,le=60,re=31,ne=62,Fe=[0,1,2,4,8,16,32],b=[0,0,0,0,0,0,0],S=0,W=0,R=!1,ue=!1,x=!1,P=!1,h=!1,C=!1,k=!1,z=!1,E=!1,fe=()=>{b=[0,0,0,0,0,0,0],S=0;let t=r;for(let e=0;e<5;e++){let s=t[e].value;S+=s,s>0&&(b[s]+=1)}Be(),Te(),de(Ie())},Te=()=>{R=!1,ue=!1,x=!1,P=!1,h=!1,C=!1,k=!1,z=!1,E=!1;for(let e=0;e<7;e++)b[e]===5&&(h=!0,C=!0),b[e]===4&&(P=!0,C=!0),b[e]===3&&(x=!0,C=!0),b[e]===2&&(R&&(ue=!0),R=!0);k=x&&R;let t=W;E=(t&re)===re||(t&ne)===ne,z=(t&oe)===oe||(t&ae)===ae||(t&le)===le},Ie=()=>h?(U?g():D(),!0):!1,Be=()=>{let t=r;W=0;for(let e=1;e<=6;e++)(t[0].value===e||t[1].value===e||t[2].value===e||t[3].value===e||t[4].value===e)&&(W+=Fe[e])};var De=6,Re=7,Ce=8,ke=9,ze=10,he=11,Ee=12,V=he,me=t=>t<6?$e(t+1):Ue(t),Ue=t=>t===he?h?50:0:t===Ce?z?30:0:t===ke?E?40:0:t===ze?k?25:0:t===Re?P||h?S:0:t===De?x||P||h?S:0:t===Ee?S:0,$e=t=>{let e=0;for(let s=0;s<5;s++)r[s].value===t&&(e+=1);return t*e};var l={text:"Roll Dice",color:"Brown",disabled:!1},be=()=>{u("RollButtonTouched",()=>{N(null),f({event:"UpdateRoll",data:m()}),ve()}),c("UpdateRoll",t=>{N(JSON.parse(t)),ve()})},ve=()=>{switch(K){case 1:l.text="Roll Again";break;case 2:l.text="Last Roll";break;case 3:l.disabled=!0,l.text="Select Score";break;default:l.text="Roll Dice",Se(0)}w()},w=()=>{o("UpdateRollButton",l)};var Le="snow",ye="gray",M,ge=class t{players;scoreItems;leftBonus;fiveOkindBonus;leftTotal;rightTotal;static _instance;static init(){t._instance||(t._instance=new t,M=t._instance)}constructor(){ee(this,Le),this.players=Z,this.scoreItems=[],this.leftBonus=0,this.fiveOkindBonus=0,this.leftTotal=0,this.rightTotal=0,xe(),be(),c("ResetTurn",e=>{this.isGameComplete()||this.resetTurn()}),c("ResetGame",()=>{this.resetGame()}),u("PopupResetGame",()=>{f({event:"ResetGame",data:""}),this.resetGame()}),u("ScoreElementResetTurn",()=>{this.isGameComplete()?(this.clearPossibleScores(),this.setLeftScores(),this.setRightScores(),this.showFinalScore(this.getWinner())):this.resetTurn()}),u("ViewWasAdded",e=>{e.type==="ScoreButton"&&this.scoreItems.push(new F(e.index,e.name))})}getWinner(){if(this.players.size===1)return this.getPlayer(0);let e=this.getPlayer(0),s=0;for(let i of this.players)i.score>s&&(s=i.score,e=i);return e}clearPossibleScores(){for(let e of this.scoreItems)e.clearPossible()}evaluatePossibleScores(){for(let e of this.scoreItems)e.setPossible()}resetTurn(){G(ie(a)),J(a.id===d.id),l.color=a.color,l.disabled=!1,l.text="Roll Dice",w(),Y(),this.clearPossibleScores(),this.setLeftScores(),this.setRightScores()}resetGame(){document.title=d.playerName,o("HidePopup",{}),G(this.getPlayer(0)),Pe();for(let e of this.scoreItems)e.reset();te(),this.leftBonus=0,this.fiveOkindBonus=0,this.leftTotal=0,this.rightTotal=0,o("UpdateLeftscore",{color:"gray",text:"left total = 0"}),se(),l.color="brown",l.text="Roll Dice",l.disabled=!1,w()}showFinalScore(e){let s;e.id!==d.id?(q(),s=e.playerName+" wins!"):(D(),s="You won!"),l.color="black",l.text=s,w(),o("UpdateInfo",s+" "+e.score),o("PopupResetGame",{show:!0,title:"You Won!",msg:s+" "+e.score}),f({event:"ShowPopup",data:{title:"Game Over",msg:e.playerName+" wins! "+e.score}})}isGameComplete(){let e=!0;for(let s of this.scoreItems)s.owned||(e=!1);return e}setLeftScores(){this.leftTotal=0;for(let s of this.players)s.score=0;let e;for(let s=0;s<6;s++)if(e=this.scoreItems[s].finalValue,e>0){this.leftTotal+=e;let i=this.scoreItems[s].owner;i&&(v(i,e),this.scoreItems[s].hasFiveOfaKind&&p>1&&v(i,100))}if(this.leftTotal>62){let s=this.getPlayer(0),i=0;for(let n of this.players)n.score>i&&(i=n.score,s=n);v(s,35),o("UpdateLeftscore",{color:s.color,text:`left total = ${this.leftTotal.toString()} + 35`})}else o("UpdateLeftscore",{color:ye,text:"left total = "+this.leftTotal.toString()});this.leftTotal===0&&o("UpdateLeftscore",{color:ye,text:"left total = 0"})}setRightScores(){let e,s=this.scoreItems.length;for(let i=6;i<s;i++)if(e=this.scoreItems[i].finalValue,e>0){let n=this.scoreItems[i].owner;n&&(v(n,e),this.scoreItems[i].hasFiveOfaKind&&p>1&&i!==V&&v(n,100))}}getPlayer(e){for(let s of this.players)if(s.idx===e)return s;return[...this.players][e]}};var K=0,I=!1,p=0,$=!1,U=!1,r=[{value:0,frozen:!1},{value:0,frozen:!1},{value:0,frozen:!1},{value:0,frozen:!1},{value:0,frozen:!1}],y=0,Se=t=>{K=t},de=t=>{I=t},Oe=t=>{$=t},Ve=t=>{U=t},we=t=>{p=t};function ot(t){if(A)return A.putImageData(t,0,0),_.toDataURL()}var xe=()=>{u("DieTouched",t=>{let{index:e}=t,s=r[e];s.value>0&&(s.frozen=!s.frozen,T(e,s.value,s.frozen),j(),f({event:"UpdateDie",data:{index:e}}))}),c("UpdateDie",t=>{let e=r[t.index];e.value>0&&(e.frozen=!e.frozen,T(t.index,e.value,e.frozen))})},Y=()=>{r.forEach((t,e)=>{t.frozen=!1,t.value=0,T(e,0,!1)}),K=0,y=0},Pe=()=>{Y(),I=!1,p=0,$=!1,U=!1},N=t=>{X(),y=0,r.forEach((e,s)=>{t===null?e.frozen||(e.value=Math.floor(Math.random()*6)+1,T(s,e.value,e.frozen)):e.frozen||(e.value=t[s],T(s,e.value,e.frozen)),y+=e.value}),K+=1,fe(),M.evaluatePossibleScores()},T=(t,e,s)=>{o("UpdateDie",{index:t,value:e,frozen:s})},m=()=>{let t="[";return r.forEach((e,s)=>{t+=e.value,s<4&&(t+=",")}),t+"]"};var Ge=8,We=9,He=10,Ke="",Q="black",F=class{available;owned;index;name;owner=null;finalValue;possibleValue;scoringDieset;scoringDiesetSum=0;hasFiveOfaKind=!1;constructor(e,s){this.available=!1,this.owned=!1,this.index=e,this.name=s,this.finalValue=0,this.possibleValue=0,this.scoringDieset=[0,0,0,0,0],u("ScoreButtonTouched",i=>{i===this.index&&(f({event:"UpdateScore",data:this.index}),this.clicked()&&(f({event:"ResetTurn",data:""}),o("ScoreElementResetTurn","")))}),c("UpdateScore",i=>{i===this.index&&this.clicked()}),u("UpdateTooltip",i=>{if(e===this.index){let n="";i.hovered?this.owned?n=`${d.playerName} owns ${this.name} with ${this.scoringDieset.toString()}`:n=`${this.name}`:n="",o("UpdateInfo",n)}})}updateInfo(e){o("UpdateInfo",e)}setOwned(e){this.owned=e,this.owned?(this.owner=a,this.updateScoreElement(this.owner.color,this.possibleValue.toString())):(this.owner=null,this.updateScoreElement(Q,Ke))}renderValue(e){o("UpdateScoreElement",{index:this.index,renderAll:!1,fillColor:this.owner?this.owner.color:Q,value:e.toString(),available:this.available})}updateScoreElement(e,s){o("UpdateScoreElement",{index:this.index,renderAll:!0,fillColor:e,value:s,available:this.available})}setAvailable(e){this.available=e,this.available?this.possibleValue>0&&this.renderValue(this.possibleValue):this.owned?this.renderValue(this.possibleValue):this.renderValue(this.possibleValue)}clicked(){if(console.log("score-clicked"),m()==="[0,0,0,0,0]")return!1;let e=!1;if(this.owned)this.available&&(a.lastScore=`stole ${this.name} ${m()} was: ${this.scoringDieset.toString()}`,this.updateInfo(`${a.playerName} ${a.lastScore}`),this.setOwned(!1),B(),this.setValue(),e=!0);else{if(this.possibleValue===0)a.lastScore=`sacrificed ${this.name} ${m()}`,this.updateInfo(`${a.playerName} ${a.lastScore}`);else{let s=a.id===d.id,i=s?"chose":"took";a.lastScore=`${i} ${this.name} ${m()}`,this.updateInfo(`${s?"You":a.playerName} ${a.lastScore}`)}this.index===V&&(I?(Oe(!0),B()):(Ve(!0),g())),this.setValue(),e=!0}return e}setValue(){this.setOwned(!0),this.finalValue=this.possibleValue,this.scoringDiesetSum=0,this.scoringDieset.forEach((e,s)=>{this.scoringDieset[s]=r[s].value,this.scoringDiesetSum+=r[s].value}),I?$?(we(p+1),this.index!==V&&(this.finalValue+=100),this.hasFiveOfaKind=!0,B()):(this.hasFiveOfaKind=!1,L()):(this.hasFiveOfaKind=!1,this.finalValue===0?g():L())}setPossible(){this.possibleValue=me(this.index),this.owned?a!==this.owner&&(this.possibleValue>this.finalValue?this.hasFiveOfaKind||(this.setAvailable(!0),this.renderValue(this.possibleValue)):(this.index===Ge||this.index===We)&&this.possibleValue===this.finalValue&&this.possibleValue>0&&this.scoringDiesetSum<y?(this.setAvailable(!0),this.renderValue(this.possibleValue)):this.index===He&&this.possibleValue===this.finalValue&&this.scoringDiesetSum<y&&(this.setAvailable(!0),this.renderValue(this.possibleValue))):(this.possibleValue===0?this.renderValue(0):this.renderValue(this.possibleValue),this.setAvailable(!0))}reset(){this.setOwned(!1),this.finalValue=0,this.possibleValue=0,this.updateScoreElement(Q,Ke),this.hasFiveOfaKind=!1}clearPossible(){this.possibleValue=0,this.setAvailable(!1),this.owned?this.renderValue(this.finalValue):(this.finalValue=0,this.renderValue(0))}},ft=["Ones","Twos","Threes","Fours","Fives","Sixes",`Three
O-Kind`,`Four
O-Kind`,`Small
Straight`,`Large
Straight`,`Full
House`,`Five
O-Kind`,"Chance"];export{ft as a,l as b,ge as c,r as d,ot as e};
